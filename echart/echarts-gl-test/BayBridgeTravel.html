
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>maptalks.E3layer Demo: Bus lines</title>
    <link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/maptalks/dist/maptalks.css">
    <style type="text/css">
        body {
            margin: 0;
        }
        #map {
            width : 100%;
            height: 1000px;
        }
    </style>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/maptalks/dist/maptalks.min.js"></script>
<script type="text/javascript" src="https://unpkg.com/maptalks.e3/dist/maptalks.e3.min.js"></script>

</head>
<body>
<div id="map"></div>
<script>
//Original Example of Echarts 3
//http://echarts.baidu.com/demo.html#geo-lines

var map = new maptalks.Map("map",{
    center :  [-77.08052, 38.965666],
    zoom   :  9,
    attributionControl : {
      'content' : '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="https://carto.com/attributions">CARTO</a>'
    },
    baseLayer : new maptalks.TileLayer('tile',{
        'urlTemplate' : 'https://cartodb-basemaps-{s}.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png',
        'subdomains': ['a','b','c','d']
    })
});

var e3Layer = new maptalks.E3Layer('e3', getECOption())
    .addTo(map);

function getECOption() {

    var convertData = function (data) {
    var res = [];
    for (var i = 0; i < data.length; i++) {
        var dataItem = data[i];
        var fromCoord = placeCoordMap[dataItem[0]];
        var toCoord = placeCoordMap[dataItem[1]];
        // console.log(fromCoord,toCoord);

        if (fromCoord && toCoord) {
            console.log('success push');
            res.push({
               fromName: dataItem[0],
               toName: dataItem[1],
            coords: [fromCoord, toCoord]
            });

        }
    }
    // console.log(res);
    return res;
}; 

    var placeCoordMap = {"Frederick": [-77.41867, 39.42634], "Bowie": [-76.73837, 38.95369], "Solomons": [-76.46109, 38.33725], "Kettering": [-76.78895, 38.88884], "Temple Hills": [-76.9495, 38.81059], "Martin\'s Additions": [-77.06925, 38.97954], "Mount Rainier": [-76.96446, 38.94264], "Brooklyn Park": [-76.61739, 39.21701], "Mays Chapel": [-76.65156, 39.43427], "Rosedale": [-76.50843, 39.32657], "Point of Rocks": [-77.52918, 39.27806], "Edgewater": [-76.55723, 38.93725], "Leisure World": [-77.06906, 39.10229], "Kensington": [-77.07375, 39.02649], "North Laurel": [-76.8476, 39.12857], "Lansdowne": [-76.65665, 39.24239], "Fulton": [-76.91632, 39.1516], "Woodmore": [-76.78098, 38.92218], "Forest Glen": [-77.04512, 39.01786], "Galesville": [-76.55138, 38.83786], "College Park": [-76.93725, 38.98477], "Hyattsville": [-76.95478, 38.96115], "Baltimore": [-76.61444, 39.30508], "Taneytown": [-77.16856, 39.65597], "Sykesville": [-76.9725, 39.36982], "District Heights": [-76.88863, 38.85886], "Berwyn Heights": [-76.91306, 38.993], "Morningside": [-76.88944, 38.82658], "Cheverly": [-76.91417, 38.92533], "Capitol Heights": [-76.90745, 38.87654], "Chevy Chase View": [-77.08097, 39.01924], "Savage": [-76.82276, 39.14854], "Friendship": [-76.58782, 38.73587], "Edgewood": [-76.29678, 39.42096], "Owings Mills": [-76.79132, 39.4115], "Redland": [-77.14656, 39.13351], "Potomac": [-77.19429, 39.0141], "Ballenger Creek": [-77.42056, 39.38074], "Four Corners": [-77.01022, 39.02352], "Springdale": [-76.84227, 38.9383], "Glassmanor": [-76.9836, 38.81813], "Essex": [-76.44579, 39.30245], "Chillum": [-76.97883, 38.96674], "Severn": [-76.69405, 39.13564], "Lake Arbor": [-76.82986, 38.90696], "Cedarville": [-76.81904, 38.66227], "Friendship Heights Village": [-77.08996, 38.96329], "Jessup": [-76.77446, 39.14567], "Mayo": [-76.51797, 38.90415], "Westphalia": [-76.82316, 38.83847], "Woodlawn": [-76.90001, 38.95051], "Layhill": [-77.04005, 39.08699], "Chevy Chase": [-77.08331, 38.98187], "Shady Side": [-76.52074, 38.8285], "East Riverdale": [-76.91133, 38.96172], "Ashton-Sandy Spring": [-77.00653, 39.15148], "Waldorf": [-76.91946, 38.60853], "Timonium": [-76.60835, 39.44627], "Milford Mill": [-76.76684, 39.34437], "Olney": [-77.0715, 39.14657], "Crofton": [-76.68002, 39.01443], "Cloverly": [-77.01891, 39.10707], "Langley Park": [-76.9808, 38.98975], "Largo": [-76.82893, 38.87999], "Rosaryville": [-76.82662, 38.7672], "South Laurel": [-76.84557, 39.06028], "Suitland": [-76.9225, 38.8492], "Brookmont": [-77.12923, 38.95457], "Edgemere": [-76.47527, 39.2329], "Silver Spring": [-77.02071, 39.0028], "Melwood": [-76.84199, 38.80206], "Adelphi": [-76.96078, 38.98993], "Brandywine": [-76.88458, 38.69635], "Camp Springs": [-76.91984, 38.80524], "Forestville": [-76.87078, 38.85177], "Middle River": [-76.43185, 39.33453], "South Kensington": [-77.06787, 39.01701], "Severna Park": [-76.5687, 39.08701], "Owings": [-76.60555, 38.71172], "Wheaton": [-77.04489, 39.03981], "Clinton": [-76.90637, 38.74989], "Bel Air South": [-76.31973, 39.50506], "Elkridge": [-76.74273, 39.19415], "Golden Beach": [-76.7019, 38.49], "Fairland": [-76.95236, 39.08966], "Walker Mill": [-76.88623, 38.87538], "Laurel": [-76.86185, 39.09505], "Aspen Hill": [-77.10256, 39.09153], "White Oak": [-76.98679, 39.04596], "North Bethesda": [-77.11909, 39.03928], "Herald Harbor": [-76.57448, 39.05162], "Manchester": [-76.88807, 39.65835], "Garrison": [-76.75151, 39.39865], "Bladensburg": [-76.92648, 38.9423], "Colmar Manor": [-76.94397, 38.9305], "Edmonston": [-76.93228, 38.94785], "Forest Heights": [-76.99952, 38.81052], "Greenbelt": [-76.88848, 38.99535], "Gaithersburg": [-77.23235, 39.13032], "Poolesville": [-77.41019, 39.14231], "Rockville": [-77.15401, 39.07859], "Takoma Park": [-77.00279, 38.98103], "Annapolis": [-76.50478, 38.9705], "Arbutus": [-76.69218, 39.24282], "Naval Academy": [-76.48789, 38.98783], "Pasadena": [-76.5376, 39.13469], "Riva": [-76.58759, 38.94487], "Riviera Beach": [-76.54722, 39.16676], "Joppatowne": [-76.35165, 39.41814], "Germantown": [-77.26431, 39.17548], "Travilah": [-77.2458, 39.05711], "Aberdeen Proving Ground": [-76.13083, 39.46727], "National Harbor": [-77.01062, 38.78835], "Seabrook": [-76.8499, 38.98019], "Konterra": [-76.90211, 39.07755], "Brock Hall": [-76.75486, 38.86174], "Marlboro Meadows": [-76.71438, 38.83739], "Queen Anne": [-76.69731, 38.90205], "Fairwood": [-76.77762, 38.95631], "Perry Hall": [-76.4781, 39.40672], "Pikesville": [-76.70198, 39.38927], "Rossville": [-76.47268, 39.35238], "White Marsh": [-76.45737, 39.38192], "Arden on the Severn": [-76.59403, 39.06919], "Arnold": [-76.49736, 39.04367], "Cape St. Claire": [-76.44712, 39.04335], "Deale": [-76.54688, 38.79098], "Ferndale": [-76.633, 39.18692], "Fort Meade": [-76.746, 39.1096], "Glen Burnie": [-76.60722, 39.15592], "Lake Shore": [-76.48758, 39.10295], "Linthicum": [-76.66254, 39.20876], "Catonsville": [-76.74239, 39.26461], "Dundalk": [-76.49417, 39.27033], "Kingsville": [-76.42043, 39.44957], "Overlea": [-76.51758, 39.36423], "Lanham": [-76.84212, 38.96206], "Oxon Hill": [-76.97329, 38.78873], "Annapolis Neck": [-76.50267, 38.93327], "Gambrills": [-76.65116, 39.09286], "Ilchester": [-76.76848, 39.2187], "Landover Hills": [-76.8914, 38.94316], "Ellicott City": [-76.8344, 39.27732], "Linganore": [-77.30257, 39.41106], "Landover": [-76.8875, 38.9241], "Glenn Dale": [-76.80402, 38.98328], "La Plata": [-76.96951, 38.53555], "Chesapeake Ranch Estates": [-76.41469, 38.3574], "Clarksburg": [-77.26167, 39.23138], "Randallstown": [-76.80244, 39.37227], "Fort Washington": [-77.00695, 38.73392], "Accokeek": [-77.0023, 38.6745], "Hillandale": [-76.97514, 39.02542], "Marlboro Village": [-76.77198, 38.82568], "North Potomac": [-77.23727, 39.09556], "Calverton": [-76.94895, 39.06277], "Reisterstown": [-76.81439, 39.45514], "Scaggsville": [-76.88428, 39.14159], "Maryland City": [-76.80503, 39.10737], "Queensland": [-76.78385, 38.80209], "Cockeysville": [-76.62996, 39.47931], "Westminster": [-77.02528, 39.5763], "Beltsville": [-76.92113, 39.03953], "Baltimore Highlands": [-76.63675, 39.23545], "Summerfield": [-76.86781, 38.90423], "Eldersburg": [-76.9463, 39.40444], "Crownsville": [-76.5903, 39.02246], "Lochearn": [-76.73067, 39.34605], "Towson": [-76.619, 39.39437], "Bel Air": [-76.3465, 39.53448], "California": [-76.49495, 38.29687], "Hillcrest Heights": [-76.96408, 38.83732], "Cabin John": [-77.16348, 38.97427], "Mitchellville": [-76.81456, 38.93579], "Andrews AFB": [-76.87439, 38.80533], "Marlton": [-76.78571, 38.76198], "Odenton": [-76.69386, 39.0661], "Burtonsville": [-76.93558, 39.11659], "Drum Point": [-76.43092, 38.32771], "Parkville": [-76.55189, 39.38321], "Thurmont": [-77.40834, 39.62253], "Damascus": [-77.20058, 39.27372], "Glenarden": [-76.85003, 38.92758], "Columbia": [-76.85902, 39.20043], "Croom": [-76.76081, 38.73433], "Parole": [-76.55188, 38.98613], "Bethesda": [-77.11877, 38.98656], "Mount Airy": [-77.15344, 39.37426],"Chester":[-76.281270,38.965666]};


var july_traveldata=[['Frederick', 'Chester', 0.00197], ['Bowie', 'Chester', 0.02787], ['Solomons', 'Chester', 0.00066], ['Kettering', 'Chester', 0.00164], ['Temple Hills', 'Chester', 0.00131], ["Martin's Additions", 'Chester', 0.00033], ['Mount Rainier', 'Chester', 0.00033], ['Brooklyn Park', 'Chester', 0.00426], ['Mays Chapel', 'Chester', 0.00033], ['Rosedale', 'Chester', 0.00131], ['Point of Rocks', 'Chester', 0.00066], ['Edgewater', 'Chester', 0.01607], ['Leisure World', 'Chester', 0.00033], ['Kensington', 'Chester', 0.00033], ['North Laurel', 'Chester', 0.0023], ['Lansdowne', 'Chester', 0.00262], ['Fulton', 'Chester', 0.00328], ['Woodmore', 'Chester', 0.00426], ['Forest Glen', 'Chester', 0.00066], ['Galesville', 'Chester', 0.00033], ['College Park', 'Chester', 0.0118], ['Hyattsville', 'Chester', 0.00131], ['Baltimore', 'Chester', 0.07049], ['Taneytown', 'Chester', 0.00033], ['Sykesville', 'Chester', 0.00033], ['District Heights', 'Chester', 0.00033], ['Berwyn Heights', 'Chester', 0.00033], ['Morningside', 'Chester', 0.00066], ['Cheverly', 'Chester', 0.00066], ['Capitol Heights', 'Chester', 0.00033], ['Chevy Chase View', 'Chester', 0.00066], ['Savage', 'Chester', 0.00033], ['Friendship', 'Chester', 0.00066], ['Edgewood', 'Chester', 0.0023], ['Owings Mills', 'Chester', 0.00295], ['Redland', 'Chester', 0.00197], ['Potomac', 'Chester', 0.00885], ['Ballenger Creek', 'Chester', 0.00131], ['Four Corners', 'Chester', 0.00098], ['Springdale', 'Chester', 0.00197], ['Glassmanor', 'Chester', 0.00033], ['Essex', 'Chester', 0.00131], ['Chillum', 'Chester', 0.00098], ['Severn', 'Chester', 0.01246], ['Lake Arbor', 'Chester', 0.00295], ['Cedarville', 'Chester', 0.00033], ['Friendship Heights Village', 'Chester', 0.00066], ['Jessup', 'Chester', 0.00852], ['Mayo', 'Chester', 0.00262], ['Westphalia', 'Chester', 0.0082], ['Woodlawn', 'Chester', 0.00328], ['Layhill', 'Chester', 0.00033], ['Chevy Chase', 'Chester', 0.0023], ['Shady Side', 'Chester', 0.00066], ['East Riverdale', 'Chester', 0.00098], ['Ashton-Sandy Spring', 'Chester', 0.00066], ['Waldorf', 'Chester', 0.00492], ['Timonium', 'Chester', 0.00164], ['Milford Mill', 'Chester', 0.00525], ['Olney', 'Chester', 0.00262], ['Crofton', 'Chester', 0.00623], ['Cloverly', 'Chester', 0.00033], ['Langley Park', 'Chester', 0.00033], ['Largo', 'Chester', 0.00328], ['Rosaryville', 'Chester', 0.00098], ['South Laurel', 'Chester', 0.00459], ['Suitland', 'Chester', 0.00393], ['Brookmont', 'Chester', 0.00066], ['Woodlawn', 'Chester', 0.00033], ['Edgemere', 'Chester', 0.00131], ['Silver Spring', 'Chester', 0.00787], ['Melwood', 'Chester', 0.00098], ['Adelphi', 'Chester', 0.00197], ['Brandywine', 'Chester', 0.00131], ['Camp Springs', 'Chester', 0.00262], ['Forestville', 'Chester', 0.00262], ['Middle River', 'Chester', 0.00262], ['South Kensington', 'Chester', 0.00066], ['Severna Park', 'Chester', 0.04328], ['Owings', 'Chester', 0.00066], ['Wheaton', 'Chester', 0.00066], ['Clinton', 'Chester', 0.00197], ['Bel Air South', 'Chester', 0.00295], ['Elkridge', 'Chester', 0.01246], ['Golden Beach', 'Chester', 0.00066], ['Fairland', 'Chester', 0.00131], ['Walker Mill', 'Chester', 0.00033], ['Laurel', 'Chester', 0.00164], ['Aspen Hill', 'Chester', 0.00164], ['White Oak', 'Chester', 0.00098], ['North Bethesda', 'Chester', 0.00557], ['Herald Harbor', 'Chester', 0.00033], ['Manchester', 'Chester', 0.00033], ['Garrison', 'Chester', 0.00066], ['Bladensburg', 'Chester', 0.00033], ['Colmar Manor', 'Chester', 0.00033], ['Edmonston', 'Chester', 0.00262], ['Forest Heights', 'Chester', 0.00066], ['Greenbelt', 'Chester', 0.00459], ['Chevy Chase', 'Chester', 0.00033], ['Gaithersburg', 'Chester', 0.00361], ['Poolesville', 'Chester', 0.00033], ['Rockville', 'Chester', 0.0082], ['Takoma Park', 'Chester', 0.00033], ['Annapolis', 'Chester', 0.05639], ['Arbutus', 'Chester', 0.01148], ['Naval Academy', 'Chester', 0.00328], ['Pasadena', 'Chester', 0.01574], ['Riva', 'Chester', 0.00262], ['Riviera Beach', 'Chester', 0.00098], ['Joppatowne', 'Chester', 0.00033], ['Germantown', 'Chester', 0.00197], ['Travilah', 'Chester', 0.00131], ['Aberdeen Proving Ground', 'Chester', 0.0023], ['National Harbor', 'Chester', 0.00197], ['Seabrook', 'Chester', 0.00033], ['Konterra', 'Chester', 0.00033], ['Brock Hall', 'Chester', 0.01377], ['Marlboro Meadows', 'Chester', 0.00295], ['Queen Anne', 'Chester', 0.00361], ['Fairwood', 'Chester', 0.00098], ['Perry Hall', 'Chester', 0.00033], ['Pikesville', 'Chester', 0.00295], ['Rossville', 'Chester', 0.00164], ['White Marsh', 'Chester', 0.00164], ['Arden on the Severn', 'Chester', 0.00098], ['Arnold', 'Chester', 0.05967], ['Cape St. Claire', 'Chester', 0.00721], ['Deale', 'Chester', 0.00098], ['Ferndale', 'Chester', 0.00754], ['Fort Meade', 'Chester', 0.00361], ['Glen Burnie', 'Chester', 0.02918], ['Lake Shore', 'Chester', 0.00328], ['Linthicum', 'Chester', 0.00787], ['Catonsville', 'Chester', 0.00197], ['Dundalk', 'Chester', 0.00393], ['Kingsville', 'Chester', 0.00066], ['Overlea', 'Chester', 0.00033], ['Lanham', 'Chester', 0.00689], ['Oxon Hill', 'Chester', 0.00066], ['Annapolis Neck', 'Chester', 0.00852], ['Gambrills', 'Chester', 0.00787], ['Ilchester', 'Chester', 0.00098], ['Landover Hills', 'Chester', 0.00033], ['Ellicott City', 'Chester', 0.00525], ['Linganore', 'Chester', 0.00164], ['Landover', 'Chester', 0.0082], ['Glenn Dale', 'Chester', 0.0023], ['La Plata', 'Chester', 0.00066], ['Chesapeake Ranch Estates', 'Chester', 0.00066], ['Clarksburg', 'Chester', 0.00033], ['Randallstown', 'Chester', 0.00033], ['Fort Washington', 'Chester', 0.00066], ['Accokeek', 'Chester', 0.00098], ['Hillandale', 'Chester', 0.00131], ['Marlboro Village', 'Chester', 0.00033], ['North Potomac', 'Chester', 0.00098], ['Calverton', 'Chester', 0.0023], ['Reisterstown', 'Chester', 0.00098], ['Scaggsville', 'Chester', 0.00033], ['Maryland City', 'Chester', 0.00623], ['Queensland', 'Chester', 0.00033], ['Cockeysville', 'Chester', 0.00262], ['Westminster', 'Chester', 0.00066], ['Beltsville', 'Chester', 0.01705], ['Baltimore Highlands', 'Chester', 0.00066], ['Summerfield', 'Chester', 0.00131], ['Eldersburg', 'Chester', 0.00197], ['Crownsville', 'Chester', 0.0023], ['Lochearn', 'Chester', 0.00033], ['Towson', 'Chester', 0.00393], ['Bel Air', 'Chester', 0.00033], ['California', 'Chester', 0.00066], ['Hillcrest Heights', 'Chester', 0.00066], ['Cabin John', 'Chester', 0.00033], ['Mitchellville', 'Chester', 0.00525], ['Andrews AFB', 'Chester', 0.00033], ['Marlton', 'Chester', 0.00557], ['Odenton', 'Chester', 0.02689], ['Burtonsville', 'Chester', 0.0023], ['Drum Point', 'Chester', 0.00033], ['Parkville', 'Chester', 0.00033], ['Thurmont', 'Chester', 0.00098], ['Damascus', 'Chester', 0.00033], ['Glenarden', 'Chester', 0.00295], ['Columbia', 'Chester', 0.01148], ['Croom', 'Chester', 0.00328], ['Parole', 'Chester', 0.20262], ['Bethesda', 'Chester', 0.01082], ['Mount Airy', 'Chester', 0.00098]];




    var planePath = 'path://M1705.06,1318.313v-89.254l-319.9-221.799l0.073-208.063c0.521-84.662-26.629-121.796-63.961-121.491c-37.332-0.305-64.482,36.829-63.961,121.491l0.073,208.063l-319.9,221.799v89.254l330.343-157.288l12.238,241.308l-134.449,92.931l0.531,42.034l175.125-42.917l175.125,42.917l0.531-42.034l-134.449-92.931l12.238-241.308L1705.06,1318.313z';



    var color = ['#a6c84c', '#ffa022', '#46bee9'];

    var traveldata=convertData(july_traveldata);

             var title = {
                    text: 'Travel flow across Bay Bridge',
                    subtext: "Junchuan Fan - CGIS,UMD",
                    x:'center',
                    y:'top',
                    textStyle: {
                           color: '#FFC107'
                         }
                      };

    var series = [ {
                    name: 'Bay bridge travel flow',
                    type: 'lines',
                    zlevel: 1,
                    effect: {
                        show: true,
                        period: 6,
                        trailLength: 0.7,
                        symbol: planePath,
                        symbolSize: 5
                    },
                    lineStyle: {
                        normal: {
                            color: '#ffa022',
                            width: 0,
                            curveness: 0.2
                        }
                    },
                    data: traveldata
                },
    
                {
                    name: 'Bay bridge travel flow',
                    type: 'effectScatter',
                    coordinateSystem: 'geo',
                    zlevel: 2,
                    rippleEffect: {
                        brushType: 'stroke'
                    },
                    label: {
                        normal: {
                            show: false,
                            position: 'right',
                            formatter: '{b}'
                        }
                    },
                    symbolSize: function (val) {
                        return Math.sqrt(5000*val[2]);
                    },
                    itemStyle: {
                        normal: {
                            color: '#ffa022'
                        }
                    },
                    data: july_traveldata.map(function (dataItem) {

    
                        return {
                            name:  dataItem[0],
                            value: placeCoordMap[dataItem[0]].concat(dataItem[2])
                        };
                    })
                }

                ];

    // console.log(series);

    return {
        tooltip: {
            trigger: 'item',
            show: false
        },
        title: title,
        series: series
    };
}
</script>
</body>
</html>
